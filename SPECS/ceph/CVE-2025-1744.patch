From b72bc56777fc7b4f63aabbf23217d082846397b7 Mon Sep 17 00:00:00 2001
From: kavyasree <kkaitepalli@microsoft.com>
Date: Tue, 11 Mar 2025 12:26:11 +0530
Subject: [PATCH] Patch for CVE-2025-1744

Reference: https://github.com/madler/zlib/commit/1eb7682f845ac9e9bf9ae35bbfb3bad5dacbd91d
---
 src/boost/libs/beast/test/extern/zlib-1.2.11/inflate.c       | 5 +++--
 .../tools/boost_install/test/iostreams/zlib-1.2.11/inflate.c | 5 +++--
 2 files changed, 6 insertions(+), 4 deletions(-)

diff --git a/src/boost/libs/beast/test/extern/zlib-1.2.11/inflate.c b/src/boost/libs/beast/test/extern/zlib-1.2.11/inflate.c
index ac333e8c2..a32c9bdba 100644
--- a/src/boost/libs/beast/test/extern/zlib-1.2.11/inflate.c
+++ b/src/boost/libs/beast/test/extern/zlib-1.2.11/inflate.c
@@ -759,8 +759,9 @@ int flush;
                 if (copy > have) copy = have;
                 if (copy) {
                     if (state->head != Z_NULL &&
-                        state->head->extra != Z_NULL) {
-                        len = state->head->extra_len - state->length;
+                        state->head->extra != Z_NULL && 
+                        (len = state->head->extra_len - state->length) <
+				state->head->extra_max) {
                         zmemcpy(state->head->extra + len, next,
                                 len + copy > state->head->extra_max ?
                                 state->head->extra_max - len : copy);
diff --git a/src/boost/tools/boost_install/test/iostreams/zlib-1.2.11/inflate.c b/src/boost/tools/boost_install/test/iostreams/zlib-1.2.11/inflate.c
index ac333e8c2..91b2e6445 100644
--- a/src/boost/tools/boost_install/test/iostreams/zlib-1.2.11/inflate.c
+++ b/src/boost/tools/boost_install/test/iostreams/zlib-1.2.11/inflate.c
@@ -759,8 +759,9 @@ int flush;
                 if (copy > have) copy = have;
                 if (copy) {
                     if (state->head != Z_NULL &&
-                        state->head->extra != Z_NULL) {
-                        len = state->head->extra_len - state->length;
+                        state->head->extra != Z_NULL &&
+                        (len = state->head->extra_len - state->length) <
+				state->head->extra_max) {
                         zmemcpy(state->head->extra + len, next,
                                 len + copy > state->head->extra_max ?
                                 state->head->extra_max - len : copy);
-- 
2.34.1

