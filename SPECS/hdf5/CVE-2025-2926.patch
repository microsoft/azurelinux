From b36c123a68f9f67f5a6de07fcd9caaf8586289c8 Mon Sep 17 00:00:00 2001
From: Binh-Minh <bmribler@hdfgroup.org>
Date: Tue, 16 Sep 2025 11:57:03 -0400
Subject: [PATCH 1/7] Fix CVE-2025-2926, CVE-2025-2913

An image size was corrupted and decoded as 0 resulting in a NULL image buffer,
which caused a NULL pointer dereference when the image being copied to the buffer.
The invalid image size was caught in the PR #5710.  This change catches right
before the copying.

Fixes GH issue #5384
Upstream Patch Reference: https://patch-diff.githubusercontent.com/raw/HDFGroup/hdf5/pull/5841.patch
---
 src/H5Ocache.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/H5Ocache.c b/src/H5Ocache.c
index 12c30cf..4337d6e 100644
--- a/src/H5Ocache.c
+++ b/src/H5Ocache.c
@@ -602,6 +602,7 @@ H5O__cache_chk_get_initial_load_size(void *_udata, size_t *image_len)
     assert(udata);
     assert(udata->oh);
     assert(image_len);
+    assert(udata->size);
 
     /* Set the image length size */
     *image_len = udata->size;
-- 
2.45.4

