From aaba852a19b5ed717a48e62baa277966cdbdcb05 Mon Sep 17 00:00:00 2001
From: kavyasree <kkaitepalli@microsoft.com>
Date: Tue, 19 Nov 2024 10:23:25 +0530
Subject: [PATCH] Fix CVE-2022-48303

---
 src/list.c | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/src/list.c b/src/list.c
index d7ef441..20ae4ee 100644
--- a/src/list.c
+++ b/src/list.c
@@ -888,6 +888,12 @@ from_header (char const *where0, size_t digs, char const *type,
 			   << (CHAR_BIT * sizeof (uintmax_t)
 			       - LG_256 - (LG_256 - 2)));
       value = (*where++ & ((1 << (LG_256 - 2)) - 1)) - signbit;
+      if (where == lim)
+        {
+          if (type && !silent)
+            ERROR ((0, 0, _("Archive base-256 value is invalid")));
+          return -1;
+        }
       for (;;)
 	{
 	  value = (value << LG_256) + (unsigned char) *where++;
-- 
2.34.1

