From 845e694cfa7d4b4f1635f44f0bafeb6ae5520740 Mon Sep 17 00:00:00 2001
From: Kanishk-Bansal <kbkanishk975@gmail.com>
Date: Mon, 27 Jan 2025 19:18:35 +0000
Subject: [PATCH] Address CVE-2022-49043

---
 xinclude.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/xinclude.c b/xinclude.c
index 0c6b3f2..55210e5 100644
--- a/xinclude.c
+++ b/xinclude.c
@@ -612,14 +612,15 @@ xmlXIncludeAddNode(xmlXIncludeCtxtPtr ctxt, xmlNodePtr cur) {
     }
     URL = xmlSaveUri(uri);
     xmlFreeURI(uri);
-    xmlFree(URI);
     if (URL == NULL) {
 	xmlXIncludeErr(ctxt, cur, XML_XINCLUDE_HREF_URI,
 	               "invalid value URI %s\n", URI);
 	if (fragment != NULL)
 	    xmlFree(fragment);
-	return(-1);
+	xmlFree(URI);
+	return(NULL);
     }
+	xmlFree(URI);
 
     if (xmlStrEqual(URL, ctxt->doc->URL))
 	local = 1;
-- 
2.45.2

