diff --git a/isisd/isis_lsp.c b/isisd/isis_lsp.c
index e3e4916..04118dd 100644
--- a/isisd/isis_lsp.c
+++ b/isisd/isis_lsp.c
@@ -22,7 +22,9 @@
 #include "hash.h"
 #include "if.h"
 #include "checksum.h"
+#ifdef CRYPTO_INTERNAL
 #include "md5.h"
+#endif
 #include "table.h"
 #include "srcdest_table.h"
 #include "lib_errors.h"
diff --git a/isisd/isis_pdu.c b/isisd/isis_pdu.c
index 1a3142e..7e7aba3 100644
--- a/isisd/isis_pdu.c
+++ b/isisd/isis_pdu.c
@@ -20,7 +20,9 @@
 #include "prefix.h"
 #include "if.h"
 #include "checksum.h"
+#ifdef CRYPTO_INTERNAL
 #include "md5.h"
+#endif
 #include "lib_errors.h"
 
 #include "isisd/isis_constants.h"
diff --git a/isisd/isis_te.c b/isisd/isis_te.c
index cf92ae4..91c21b7 100644
--- a/isisd/isis_te.c
+++ b/isisd/isis_te.c
@@ -24,7 +24,9 @@
 #include "if.h"
 #include "vrf.h"
 #include "checksum.h"
+#ifdef CRYPTO_INTERNAL
 #include "md5.h"
+#endif
 #include "sockunion.h"
 #include "network.h"
 #include "sbuf.h"
diff --git a/lib/subdir.am b/lib/subdir.am
index 44090e6..a598fe4 100644
--- a/lib/subdir.am
+++ b/lib/subdir.am
@@ -70,7 +70,6 @@ lib_libfrr_la_SOURCES = \
 	lib/log_filter.c \
 	lib/log_nb.c \
 	lib/log_vty.c \
-	lib/md5.c \
 	lib/memory.c \
 	lib/mgmt_be_client.c \
 	lib/mgmt_fe_client.c \
@@ -105,7 +104,6 @@ lib_libfrr_la_SOURCES = \
 	lib/routemap_northbound.c \
 	lib/sbuf.c \
 	lib/seqlock.c \
-	lib/sha256.c \
 	lib/sigevent.c \
 	lib/skiplist.c \
 	lib/sockopt.c \
@@ -257,7 +255,6 @@ nobase_pkginclude_HEADERS += \
 	lib/link_state.h \
 	lib/log.h \
 	lib/log_vty.h \
-	lib/md5.h \
 	lib/memory.h \
 	lib/mgmt_be_client.h \
 	lib/mgmt_defines.h \
@@ -292,7 +289,6 @@ nobase_pkginclude_HEADERS += \
 	lib/route_opaque.h \
 	lib/sbuf.h \
 	lib/seqlock.h \
-	lib/sha256.h \
 	lib/sigevent.h \
 	lib/skiplist.h \
 	lib/smux.h \
