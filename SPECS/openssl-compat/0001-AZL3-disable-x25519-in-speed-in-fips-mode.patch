From 169288f58b6c748966549d3acce95768e0be720f Mon Sep 17 00:00:00 2001
From: rpm-build <rpm-build>
Date: Wed, 23 Jul 2025 19:22:50 +0000
Subject: [PATCH] AZL3 -- disable x25519 in speed in fips mode

---
 apps/speed.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/apps/speed.c b/apps/speed.c
index e12eadb..5f586aa 100644
--- a/apps/speed.c
+++ b/apps/speed.c
@@ -2555,6 +2555,7 @@ int speed_main(int argc, char **argv)
     // TOBIASB: Disable DSA for FIPS provider bcecause it isn't supported.
     // TOBIASB: Disable KMAC for FIPS provider because it isn't supported.
     // TOBIASB: Disable brainpool for FIPS provider because it isn't supported. See curve_list in ec_curve.c.
+    // TOBIASB: Disable X25519 for FIPS provider because it isn't supported.
     if (FIPS_mode()) {
         for (i = 0; i < RSA_NUM; i++) {
             if (rsa_keys[i].bits < 2048)
@@ -2571,7 +2572,8 @@ int speed_main(int argc, char **argv)
                 || ec_curves[i].nid == NID_brainpoolP384r1
                 || ec_curves[i].nid == NID_brainpoolP384t1
                 || ec_curves[i].nid == NID_brainpoolP512r1
-                || ec_curves[i].nid == NID_brainpoolP512t1) {
+                || ec_curves[i].nid == NID_brainpoolP512t1
+                || ec_curves[i].nid == NID_X25519) {
                 ecdsa_doit[i] = 0;
                 ecdh_doit[i] = 0;
             }
-- 
2.45.4

