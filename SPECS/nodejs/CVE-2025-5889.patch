From 5ac97cd987e7dcc2d5ccd0803eb184a7954b2176 Mon Sep 17 00:00:00 2001
From: Aninda <v-anipradhan@microsoft.com>
Date: Sat, 21 Jun 2025 07:40:51 -0400
Subject: [PATCH] Address CVE-2025-5889
Upstream Patch Reference: https://github.com/juliangruber/brace-expansion/pull/65/commits/a5b98a4f30d7813266b221435e1eaaf25a1b0ac5
---
 deps/minimatch/src/node_modules/brace-expansion/index.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/deps/minimatch/src/node_modules/brace-expansion/index.js b/deps/minimatch/src/node_modules/brace-expansion/index.js
index 4af9ddee..a27f81ce 100644
--- a/deps/minimatch/src/node_modules/brace-expansion/index.js
+++ b/deps/minimatch/src/node_modules/brace-expansion/index.js
@@ -116,7 +116,7 @@ function expand(str, isTop) {
     var isOptions = m.body.indexOf(',') >= 0;
     if (!isSequence && !isOptions) {
       // {a},b}
-      if (m.post.match(/,.*\}/)) {
+      if (m.post.match(/,(?!,).*\}/)) {
         str = m.pre + '{' + m.body + escClose + m.post;
         return expand(str);
       }
-- 
2.34.1

