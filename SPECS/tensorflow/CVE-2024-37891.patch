From 9ed4ab931b06e94e091dceff765d57b3cea1c372 Mon Sep 17 00:00:00 2001
From: kavyasree <kkaitepalli@microsoft.com>
Date: Fri, 22 Nov 2024 12:07:12 +0530
Subject: [PATCH] Fix CVE-2024-37891

---
 pypi__pip/pip/_vendor/urllib3/util/retry.py                   | 4 +++-
 pypi_urllib3/site-packages/urllib3/util/retry.py              | 4 +++-
 .../site-packages/pip/_vendor/urllib3/util/retry.py           | 4 +++-
 .../site-packages/pip/_vendor/urllib3/util/retry.py           | 4 +++-
 .../site-packages/pip/_vendor/urllib3/util/retry.py           | 4 +++-
 .../site-packages/pip/_vendor/urllib3/util/retry.py           | 4 +++-
 .../site-packages/pip/_vendor/urllib3/util/retry.py           | 4 +++-
 .../Lib/site-packages/pip/_vendor/urllib3/util/retry.py       | 4 +++-
 .../site-packages/pip/_vendor/urllib3/util/retry.py           | 4 +++-
 9 files changed, 27 insertions(+), 9 deletions(-)

diff --git a/pypi__pip/pip/_vendor/urllib3/util/retry.py b/pypi__pip/pip/_vendor/urllib3/util/retry.py
index 2490d5e5b..9a1e90d0b 100644
--- a/pypi__pip/pip/_vendor/urllib3/util/retry.py
+++ b/pypi__pip/pip/_vendor/urllib3/util/retry.py
@@ -235,7 +235,9 @@ class Retry(object):
     RETRY_AFTER_STATUS_CODES = frozenset([413, 429, 503])
 
     #: Default headers to be used for ``remove_headers_on_redirect``
-    DEFAULT_REMOVE_HEADERS_ON_REDIRECT = frozenset(["Authorization"])
+    DEFAULT_REMOVE_HEADERS_ON_REDIRECT = frozenset(
+        ["Cookie", "Authorization", "Proxy-Authorization"]
+    )
 
     #: Maximum backoff time.
     DEFAULT_BACKOFF_MAX = 120
diff --git a/pypi_urllib3/site-packages/urllib3/util/retry.py b/pypi_urllib3/site-packages/urllib3/util/retry.py
index 7572bfd26..1d40f702f 100644
--- a/pypi_urllib3/site-packages/urllib3/util/retry.py
+++ b/pypi_urllib3/site-packages/urllib3/util/retry.py
@@ -187,7 +187,9 @@ class Retry:
     RETRY_AFTER_STATUS_CODES = frozenset([413, 429, 503])
 
     #: Default headers to be used for ``remove_headers_on_redirect``
-    DEFAULT_REMOVE_HEADERS_ON_REDIRECT = frozenset(["Cookie", "Authorization"])
+    DEFAULT_REMOVE_HEADERS_ON_REDIRECT = frozenset(
+        ["Cookie", "Authorization", "Proxy-Authorization"]
+    )
 
     #: Default maximum backoff time.
     DEFAULT_BACKOFF_MAX = 120
diff --git a/python_aarch64-apple-darwin/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py b/python_aarch64-apple-darwin/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py
index 2490d5e5b..9a1e90d0b 100644
--- a/python_aarch64-apple-darwin/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py
+++ b/python_aarch64-apple-darwin/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py
@@ -235,7 +235,9 @@ class Retry(object):
     RETRY_AFTER_STATUS_CODES = frozenset([413, 429, 503])
 
     #: Default headers to be used for ``remove_headers_on_redirect``
-    DEFAULT_REMOVE_HEADERS_ON_REDIRECT = frozenset(["Authorization"])
+    DEFAULT_REMOVE_HEADERS_ON_REDIRECT = frozenset(
+        ["Cookie", "Authorization", "Proxy-Authorization"]
+    )
 
     #: Maximum backoff time.
     DEFAULT_BACKOFF_MAX = 120
diff --git a/python_aarch64-unknown-linux-gnu/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py b/python_aarch64-unknown-linux-gnu/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py
index 2490d5e5b..9a1e90d0b 100644
--- a/python_aarch64-unknown-linux-gnu/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py
+++ b/python_aarch64-unknown-linux-gnu/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py
@@ -235,7 +235,9 @@ class Retry(object):
     RETRY_AFTER_STATUS_CODES = frozenset([413, 429, 503])
 
     #: Default headers to be used for ``remove_headers_on_redirect``
-    DEFAULT_REMOVE_HEADERS_ON_REDIRECT = frozenset(["Authorization"])
+    DEFAULT_REMOVE_HEADERS_ON_REDIRECT = frozenset(
+        ["Cookie", "Authorization", "Proxy-Authorization"]
+    )
 
     #: Maximum backoff time.
     DEFAULT_BACKOFF_MAX = 120
diff --git a/python_ppc64le-unknown-linux-gnu/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py b/python_ppc64le-unknown-linux-gnu/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py
index 2490d5e5b..9a1e90d0b 100644
--- a/python_ppc64le-unknown-linux-gnu/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py
+++ b/python_ppc64le-unknown-linux-gnu/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py
@@ -235,7 +235,9 @@ class Retry(object):
     RETRY_AFTER_STATUS_CODES = frozenset([413, 429, 503])
 
     #: Default headers to be used for ``remove_headers_on_redirect``
-    DEFAULT_REMOVE_HEADERS_ON_REDIRECT = frozenset(["Authorization"])
+    DEFAULT_REMOVE_HEADERS_ON_REDIRECT = frozenset(
+        ["Cookie", "Authorization", "Proxy-Authorization"]
+    )
 
     #: Maximum backoff time.
     DEFAULT_BACKOFF_MAX = 120
diff --git a/python_s390x-unknown-linux-gnu/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py b/python_s390x-unknown-linux-gnu/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py
index 2490d5e5b..9a1e90d0b 100644
--- a/python_s390x-unknown-linux-gnu/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py
+++ b/python_s390x-unknown-linux-gnu/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py
@@ -235,7 +235,9 @@ class Retry(object):
     RETRY_AFTER_STATUS_CODES = frozenset([413, 429, 503])
 
     #: Default headers to be used for ``remove_headers_on_redirect``
-    DEFAULT_REMOVE_HEADERS_ON_REDIRECT = frozenset(["Authorization"])
+    DEFAULT_REMOVE_HEADERS_ON_REDIRECT = frozenset(
+        ["Cookie", "Authorization", "Proxy-Authorization"]
+    )
 
     #: Maximum backoff time.
     DEFAULT_BACKOFF_MAX = 120
diff --git a/python_x86_64-apple-darwin/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py b/python_x86_64-apple-darwin/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py
index 2490d5e5b..9a1e90d0b 100644
--- a/python_x86_64-apple-darwin/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py
+++ b/python_x86_64-apple-darwin/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py
@@ -235,7 +235,9 @@ class Retry(object):
     RETRY_AFTER_STATUS_CODES = frozenset([413, 429, 503])
 
     #: Default headers to be used for ``remove_headers_on_redirect``
-    DEFAULT_REMOVE_HEADERS_ON_REDIRECT = frozenset(["Authorization"])
+    DEFAULT_REMOVE_HEADERS_ON_REDIRECT = frozenset(
+        ["Cookie", "Authorization", "Proxy-Authorization"]
+    )
 
     #: Maximum backoff time.
     DEFAULT_BACKOFF_MAX = 120
diff --git a/python_x86_64-pc-windows-msvc/Lib/site-packages/pip/_vendor/urllib3/util/retry.py b/python_x86_64-pc-windows-msvc/Lib/site-packages/pip/_vendor/urllib3/util/retry.py
index 2490d5e5b..9a1e90d0b 100644
--- a/python_x86_64-pc-windows-msvc/Lib/site-packages/pip/_vendor/urllib3/util/retry.py
+++ b/python_x86_64-pc-windows-msvc/Lib/site-packages/pip/_vendor/urllib3/util/retry.py
@@ -235,7 +235,9 @@ class Retry(object):
     RETRY_AFTER_STATUS_CODES = frozenset([413, 429, 503])
 
     #: Default headers to be used for ``remove_headers_on_redirect``
-    DEFAULT_REMOVE_HEADERS_ON_REDIRECT = frozenset(["Authorization"])
+    DEFAULT_REMOVE_HEADERS_ON_REDIRECT = frozenset(
+        ["Cookie", "Authorization", "Proxy-Authorization"]
+    )
 
     #: Maximum backoff time.
     DEFAULT_BACKOFF_MAX = 120
diff --git a/python_x86_64-unknown-linux-gnu/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py b/python_x86_64-unknown-linux-gnu/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py
index 2490d5e5b..9a1e90d0b 100644
--- a/python_x86_64-unknown-linux-gnu/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py
+++ b/python_x86_64-unknown-linux-gnu/lib/python3.12/site-packages/pip/_vendor/urllib3/util/retry.py
@@ -235,7 +235,9 @@ class Retry(object):
     RETRY_AFTER_STATUS_CODES = frozenset([413, 429, 503])
 
     #: Default headers to be used for ``remove_headers_on_redirect``
-    DEFAULT_REMOVE_HEADERS_ON_REDIRECT = frozenset(["Authorization"])
+    DEFAULT_REMOVE_HEADERS_ON_REDIRECT = frozenset(
+        ["Cookie", "Authorization", "Proxy-Authorization"]
+    )
 
     #: Maximum backoff time.
     DEFAULT_BACKOFF_MAX = 120
-- 
2.34.1

