From 8ffad66f28fba17ac98ff9c073b80c33ae683764 Mon Sep 17 00:00:00 2001
From: kavyasree <kkaitepalli@microsoft.com>
Date: Tue, 17 Dec 2024 14:04:23 +0530
Subject: [PATCH] Patch CVE-2020-22217

---
 com_github_cares_cares/ares_parse_soa_reply.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/com_github_cares_cares/ares_parse_soa_reply.c b/com_github_cares_cares/ares_parse_soa_reply.c
index 35af0a75c0..5924bbca97 100644
--- a/com_github_cares_cares/ares_parse_soa_reply.c
+++ b/com_github_cares_cares/ares_parse_soa_reply.c
@@ -65,6 +65,9 @@ ares_parse_soa_reply(const unsigned char *abuf, int alen,
   status = ares__expand_name_for_response(aptr, abuf, alen, &qname, &len);
   if (status != ARES_SUCCESS)
     goto failed_stat;
+
+  if (alen <= len + HFIXEDSZ + 1)
+    goto failed;
   aptr += len;
 
   /* skip qtype & qclass */
-- 
2.34.1

