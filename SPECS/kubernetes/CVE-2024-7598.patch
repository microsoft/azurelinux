From ca114e4c8e9dcf54dac63c2a8b37314840b1c8ff Mon Sep 17 00:00:00 2001
From: AllSpark <allspark@microsoft.com>
Date: Sat, 1 Nov 2025 04:42:58 +0000
Subject: [PATCH] Promote feature OrderedNamespaceDeletion to GA.

Signed-off-by: Azure Linux Security Servicing Account <azurelinux-security@microsoft.com>
Upstream-reference: AI Backport of https://github.com/kubernetes/kubernetes/pull/131514/commits/eb3c9a3184aabf89405f05fafb6f2bf91ba92226.patch
---
 pkg/features/kube_features.go | 9 +++++++++
 test/e2e/apimachinery/namespace.go | 1 +
 2 file changed, 10 insertions(+)

diff --git a/pkg/features/kube_features.go b/pkg/features/kube_features.go
index 56791b47..4730be4a 100644
--- a/pkg/features/kube_features.go
+++ b/pkg/features/kube_features.go
@@ -618,6 +618,13 @@ const (
 	// Permits kubelet to run with swap enabled
 	NodeSwap featuregate.Feature = "NodeSwap"
 
+	// owner: @sig-apimachinery
+	// beta: v1.33
+	// GA: v1.34
+	//
+	// Enables ordered deletion of namespaces to improve deletion determinism.
+	OrderedNamespaceDeletion featuregate.Feature = "OrderedNamespaceDeletion"
+
 	// owner: @mortent, @atiratree, @ravig
 	// kep: http://kep.k8s.io/3018
 	// alpha: v1.26
@@ -1103,6 +1110,8 @@ var defaultKubernetesFeatureGates = map[featuregate.Feature]featuregate.FeatureS
 
 	NodeSwap: {Default: false, PreRelease: featuregate.Beta},
 
+	OrderedNamespaceDeletion: {Default: true, PreRelease: featuregate.GA, LockToDefault: true},
+
 	PDBUnhealthyPodEvictionPolicy: {Default: true, PreRelease: featuregate.Beta},
 
 	PersistentVolumeLastPhaseTransitionTime: {Default: false, PreRelease: featuregate.Alpha},
diff --git a/test/e2e/apimachinery/namespace.go b/test/e2e/apimachinery/namespace.go
index 8bc52bce..13931874 100644
--- a/test/e2e/apimachinery/namespace.go
+++ b/test/e2e/apimachinery/namespace.go
@@ -35,6 +35,7 @@ import (
 	"k8s.io/apimachinery/pkg/util/wait"
 	clientscheme "k8s.io/client-go/kubernetes/scheme"
 	"k8s.io/client-go/util/retry"
+	"k8s.io/kubernetes/pkg/features"
 	"k8s.io/kubernetes/test/e2e/framework"
 	e2epod "k8s.io/kubernetes/test/e2e/framework/pod"
 	imageutils "k8s.io/kubernetes/test/utils/image"
-- 
2.45.4

