From eef7621da1f785e18481bf746af4e08e5f21495e Mon Sep 17 00:00:00 2001
From: AllSpark <allspark@microsoft.com>
Date: Mon, 12 Jan 2026 16:41:13 +0000
Subject: [PATCH] Fix CVE-2025-13151: Prevent stack-based buffer overflow by
 increasing buffer size in decoding.c; Update NEWS with vulnerability fix note

Signed-off-by: Azure Linux Security Servicing Account <azurelinux-security@microsoft.com>
Upstream-reference: AI Backport of https://gitlab.com/gnutls/libtasn1/-/commit/d276cc495a2a32b182c3c39851f1ba58f2d9f9b8.patch
---
 NEWS                     | 2 ++
 lib/minitasn1/decoding.c | 2 +-
 2 files changed, 3 insertions(+), 1 deletion(-)

diff --git a/NEWS b/NEWS
index 5e32a3b..c9852ba 100644
--- a/NEWS
+++ b/NEWS
@@ -5,6 +5,8 @@ Copyright (C) 2000-2016 Free Software Foundation, Inc.
 Copyright (C) 2013-2019 Nikos Mavrogiannopoulos
 See the end for copying conditions.
 
+- Fix for vulnerbaility CVE-2025-13151 Stack-based buffer overflow
+
 * Version 3.8.3 (released 2024-01-16)
 
 ** libgnutls: Fix more timing side-channel inside RSA-PSK key exchange
diff --git a/lib/minitasn1/decoding.c b/lib/minitasn1/decoding.c
index b9245c4..bc45138 100644
--- a/lib/minitasn1/decoding.c
+++ b/lib/minitasn1/decoding.c
@@ -1976,7 +1976,7 @@ int
 asn1_expand_octet_string (asn1_node_const definitions, asn1_node * element,
 			  const char *octetName, const char *objectName)
 {
-  char name[2 * ASN1_MAX_NAME_SIZE + 1], value[ASN1_MAX_NAME_SIZE];
+  char name[2 * ASN1_MAX_NAME_SIZE + 2], value[ASN1_MAX_NAME_SIZE];
   int retCode = ASN1_SUCCESS, result;
   int len, len2, len3;
   asn1_node_const p2;
-- 
2.45.4

