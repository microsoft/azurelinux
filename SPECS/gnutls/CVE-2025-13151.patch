From 822e79c45d52b8cc56a8e346b41d40eb5e5db409 Mon Sep 17 00:00:00 2001
From: AllSpark <allspark@microsoft.com>
Date: Mon, 12 Jan 2026 16:39:52 +0000
Subject: [PATCH] Fix for CVE-2025-13151 Buffer overflow: expand name buffer by
 +1; add NEWS entry

Signed-off-by: Azure Linux Security Servicing Account <azurelinux-security@microsoft.com>
Upstream-reference: AI Backport of https://gitlab.com/gnutls/libtasn1/-/commit/d276cc495a2a32b182c3c39851f1ba58f2d9f9b8.patch
---
 NEWS                     | 3 +++
 lib/minitasn1/decoding.c | 2 +-
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/NEWS b/NEWS
index f52bf55..cb48d22 100644
--- a/NEWS
+++ b/NEWS
@@ -26,6 +26,9 @@ See the end for copying conditions.
 ** libgnutls: Fix timing side-channel inside RSA-PSK key exchange.
    [GNUTLS-SA-2023-10-23, CVSS: medium] [CVE-2023-5981]
 
+** libminitasn1: Fix for vulnerbaility CVE-2025-13151 Stack-based buffer overflow
+
+
 ** API and ABI modifications:
 No changes since last version.
 
diff --git a/lib/minitasn1/decoding.c b/lib/minitasn1/decoding.c
index 378219c..add0502 100644
--- a/lib/minitasn1/decoding.c
+++ b/lib/minitasn1/decoding.c
@@ -1968,7 +1968,7 @@ int
 asn1_expand_octet_string (asn1_node_const definitions, asn1_node * element,
 			  const char *octetName, const char *objectName)
 {
-  char name[2 * ASN1_MAX_NAME_SIZE + 1], value[ASN1_MAX_NAME_SIZE];
+  char name[2 * ASN1_MAX_NAME_SIZE + 2], value[ASN1_MAX_NAME_SIZE];
   int retCode = ASN1_SUCCESS, result;
   int len, len2, len3;
   asn1_node_const p2;
-- 
2.45.4

