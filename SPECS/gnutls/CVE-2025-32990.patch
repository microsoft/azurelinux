From bdc30f568829c08f52705ee60ad4914502345d29 Mon Sep 17 00:00:00 2001
From: Azure Linux Security Servicing Account
 <azurelinux-security@microsoft.com>
Date: Mon, 14 Jul 2025 13:56:33 +0000
Subject: [PATCH] Fix CVE CVE-2025-32990 in gnutls

Upstream Patch Reference: https://gitlab.com/gnutls/gnutls/-/commit/8a36455fd75ce76391cfc00c53213d8b0e1648da.patch
---
 src/certtool-cfg.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/certtool-cfg.c b/src/certtool-cfg.c
index 2d7a1dc..bce2390 100644
--- a/src/certtool-cfg.c
+++ b/src/certtool-cfg.c
@@ -257,7 +257,7 @@ void cfg_init(void)
 	if (val != NULL) {                                                 \
 		if (s_name == NULL) {                                      \
 			i = 0;                                             \
-			s_name = malloc(sizeof(char *) * MAX_ENTRIES);     \
+			s_name = calloc(MAX_ENTRIES + 1, sizeof(char *));  \
 			CHECK_MALLOC(s_name);                              \
 			do {                                               \
 				if (val && strcmp(val->name, k_name) != 0) \
@@ -279,7 +279,7 @@ void cfg_init(void)
 		char *p;                                                      \
 		if (s_name == NULL) {                                         \
 			i = 0;                                                \
-			s_name = malloc(sizeof(char *) * MAX_ENTRIES);        \
+			s_name = calloc(MAX_ENTRIES + 1, sizeof(char *));     \
 			CHECK_MALLOC(s_name);                                 \
 			do {                                                  \
 				if (val && strcmp(val->name, k_name) != 0)    \
-- 
2.45.3

