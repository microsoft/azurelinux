From 62d2d592239e7dad04d29484d572f559e7dc4592 Mon Sep 17 00:00:00 2001
From: Patch Pilot <patch.pilot@microsoft.com>
Date: Mon, 11 Aug 2025 19:38:12 +0000
Subject: [PATCH] ICU-22973 Fix buffer overflow by using CharString in
 parse.cpp: replace stack char buffers with CharString and update calls to use
 .data(); appendInvariantChars with error checks.

Signed-off-by: Azure Linux Security Servicing Account <azurelinux-security@microsoft.com>
Upstream-reference: /mnt/vss/_work/1/s/autosec/backported/CVE-2025-5222.patch
---
 build/scripts/build-icu-arm64.sh              |  0
 build/scripts/build-icu-x64.sh                |  0
 icu/icu4c/as_is/bomlist.py                    |  0
 icu/icu4c/as_is/os390/unpax-icu.sh            |  0
 icu/icu4c/as_is/os400/bldiculd.sh             |  0
 icu/icu4c/as_is/os400/fixup-icu.sh            |  0
 icu/icu4c/as_is/os400/unpax-icu.sh            |  0
 icu/icu4c/source/common/rbbicst.pl            |  0
 icu/icu4c/source/config/dist-data.sh          |  0
 icu/icu4c/source/config/test-icu-config.sh    |  0
 icu/icu4c/source/configure                    |  0
 icu/icu4c/source/data/unidata/clean.sh        |  0
 icu/icu4c/source/data/unidata/generate.sh     |  0
 icu/icu4c/source/i18n/regexcst.pl             |  0
 icu/icu4c/source/install-sh                   |  0
 icu/icu4c/source/runConfigureICU              |  0
 icu/icu4c/source/test/compat/tzone.pl         |  0
 .../source/test/depstest/dependencies.py      |  0
 icu/icu4c/source/test/depstest/depstest.py    |  0
 .../source/test/hdrtst/testinternalheaders.sh |  0
 .../source/test/hdrtst/testtagsguards.sh      |  0
 .../source/test/perf/charperf/CharPerf.pl     |  0
 .../source/test/perf/charperf/CharPerf_r.pl   |  0
 .../test/perf/collationperf/CollPerf.pl       |  0
 .../source/test/perf/collperf/CollPerf.pl     |  0
 .../source/test/perf/collperf/CollPerf_r.pl   |  0
 .../source/test/perf/collperf2/CollPerf2_r.pl |  0
 .../source/test/perf/convperf/ConvPerf_r.pl   |  0
 .../test/perf/convperf/convperf_ansi.pl       |  0
 .../source/test/perf/convperf/convperf_iml.pl |  0
 .../source/test/perf/localecanperf/runTest.sh |  0
 .../source/test/perf/normperf/NormPerf.pl     |  0
 .../source/test/perf/normperf/NormPerf_r.pl   |  0
 .../test/perf/perldriver/Common.pl.template   |  0
 .../test/perf/strsrchperf/StrSrchPerf_r.pl    |  0
 .../source/test/perf/ubrkperf/UBrkPerf_r.pl   |  0
 .../test/perf/unisetperf/draft/contperf.bat   |  0
 .../test/perf/unisetperf/draft/contperf.sh    |  0
 .../test/perf/unisetperf/draft/span16perf.bat |  0
 .../test/perf/unisetperf/draft/span16perf.sh  |  0
 .../test/perf/unisetperf/draft/span8perf.bat  |  0
 .../test/perf/unisetperf/draft/span8perf.sh   |  0
 .../source/test/perf/unisetperf/unisetperf.pl |  0
 .../source/test/perf/usetperf/UsetPerf.pl     |  0
 .../source/test/perf/ustrperf/StringPerf.pl   |  0
 .../source/test/perf/ustrperf/StringPerf_r.pl |  0
 icu/icu4c/source/test/perf/utfperf/UtfPerf.pl |  0
 .../test/perf/utrie2perf/utrie2perf.bat       |  0
 .../source/test/perf/utrie2perf/utrie2perf.sh |  0
 icu/icu4c/source/tools/genrb/parse.cpp        | 48 +++++++++++--------
 icu/icu4c/source/tools/genren/genren.pl       |  0
 .../source/tools/gensprep/filterRFC3454.pl    |  0
 .../source/tools/memcheck/ICUMemCheck.pl      |  0
 icu/tools/cldr/lib/install-cldr-jars.sh       |  0
 54 files changed, 29 insertions(+), 19 deletions(-)
 mode change 100755 => 100644 build/scripts/build-icu-arm64.sh
 mode change 100755 => 100644 build/scripts/build-icu-x64.sh
 mode change 100755 => 100644 icu/icu4c/as_is/bomlist.py
 mode change 100755 => 100644 icu/icu4c/as_is/os390/unpax-icu.sh
 mode change 100755 => 100644 icu/icu4c/as_is/os400/bldiculd.sh
 mode change 100755 => 100644 icu/icu4c/as_is/os400/fixup-icu.sh
 mode change 100755 => 100644 icu/icu4c/as_is/os400/unpax-icu.sh
 mode change 100755 => 100644 icu/icu4c/source/common/rbbicst.pl
 mode change 100755 => 100644 icu/icu4c/source/config/dist-data.sh
 mode change 100755 => 100644 icu/icu4c/source/config/test-icu-config.sh
 mode change 100755 => 100644 icu/icu4c/source/configure
 mode change 100755 => 100644 icu/icu4c/source/data/unidata/clean.sh
 mode change 100755 => 100644 icu/icu4c/source/data/unidata/generate.sh
 mode change 100755 => 100644 icu/icu4c/source/i18n/regexcst.pl
 mode change 100755 => 100644 icu/icu4c/source/install-sh
 mode change 100755 => 100644 icu/icu4c/source/runConfigureICU
 mode change 100755 => 100644 icu/icu4c/source/test/compat/tzone.pl
 mode change 100755 => 100644 icu/icu4c/source/test/depstest/dependencies.py
 mode change 100755 => 100644 icu/icu4c/source/test/depstest/depstest.py
 mode change 100755 => 100644 icu/icu4c/source/test/hdrtst/testinternalheaders.sh
 mode change 100755 => 100644 icu/icu4c/source/test/hdrtst/testtagsguards.sh
 mode change 100755 => 100644 icu/icu4c/source/test/perf/charperf/CharPerf.pl
 mode change 100755 => 100644 icu/icu4c/source/test/perf/charperf/CharPerf_r.pl
 mode change 100755 => 100644 icu/icu4c/source/test/perf/collationperf/CollPerf.pl
 mode change 100755 => 100644 icu/icu4c/source/test/perf/collperf/CollPerf.pl
 mode change 100755 => 100644 icu/icu4c/source/test/perf/collperf/CollPerf_r.pl
 mode change 100755 => 100644 icu/icu4c/source/test/perf/collperf2/CollPerf2_r.pl
 mode change 100755 => 100644 icu/icu4c/source/test/perf/convperf/ConvPerf_r.pl
 mode change 100755 => 100644 icu/icu4c/source/test/perf/convperf/convperf_ansi.pl
 mode change 100755 => 100644 icu/icu4c/source/test/perf/convperf/convperf_iml.pl
 mode change 100755 => 100644 icu/icu4c/source/test/perf/localecanperf/runTest.sh
 mode change 100755 => 100644 icu/icu4c/source/test/perf/normperf/NormPerf.pl
 mode change 100755 => 100644 icu/icu4c/source/test/perf/normperf/NormPerf_r.pl
 mode change 100755 => 100644 icu/icu4c/source/test/perf/perldriver/Common.pl.template
 mode change 100755 => 100644 icu/icu4c/source/test/perf/strsrchperf/StrSrchPerf_r.pl
 mode change 100755 => 100644 icu/icu4c/source/test/perf/ubrkperf/UBrkPerf_r.pl
 mode change 100755 => 100644 icu/icu4c/source/test/perf/unisetperf/draft/contperf.bat
 mode change 100755 => 100644 icu/icu4c/source/test/perf/unisetperf/draft/contperf.sh
 mode change 100755 => 100644 icu/icu4c/source/test/perf/unisetperf/draft/span16perf.bat
 mode change 100755 => 100644 icu/icu4c/source/test/perf/unisetperf/draft/span16perf.sh
 mode change 100755 => 100644 icu/icu4c/source/test/perf/unisetperf/draft/span8perf.bat
 mode change 100755 => 100644 icu/icu4c/source/test/perf/unisetperf/draft/span8perf.sh
 mode change 100755 => 100644 icu/icu4c/source/test/perf/unisetperf/unisetperf.pl
 mode change 100755 => 100644 icu/icu4c/source/test/perf/usetperf/UsetPerf.pl
 mode change 100755 => 100644 icu/icu4c/source/test/perf/ustrperf/StringPerf.pl
 mode change 100755 => 100644 icu/icu4c/source/test/perf/ustrperf/StringPerf_r.pl
 mode change 100755 => 100644 icu/icu4c/source/test/perf/utfperf/UtfPerf.pl
 mode change 100755 => 100644 icu/icu4c/source/test/perf/utrie2perf/utrie2perf.bat
 mode change 100755 => 100644 icu/icu4c/source/test/perf/utrie2perf/utrie2perf.sh
 mode change 100755 => 100644 icu/icu4c/source/tools/genren/genren.pl
 mode change 100755 => 100644 icu/icu4c/source/tools/gensprep/filterRFC3454.pl
 mode change 100755 => 100644 icu/icu4c/source/tools/memcheck/ICUMemCheck.pl
 mode change 100755 => 100644 icu/tools/cldr/lib/install-cldr-jars.sh

diff --git a/build/scripts/build-icu-arm64.sh b/build/scripts/build-icu-arm64.sh
old mode 100755
new mode 100644
diff --git a/build/scripts/build-icu-x64.sh b/build/scripts/build-icu-x64.sh
old mode 100755
new mode 100644
diff --git a/icu/icu4c/as_is/bomlist.py b/icu/icu4c/as_is/bomlist.py
old mode 100755
new mode 100644
diff --git a/icu/icu4c/as_is/os390/unpax-icu.sh b/icu/icu4c/as_is/os390/unpax-icu.sh
old mode 100755
new mode 100644
diff --git a/icu/icu4c/as_is/os400/bldiculd.sh b/icu/icu4c/as_is/os400/bldiculd.sh
old mode 100755
new mode 100644
diff --git a/icu/icu4c/as_is/os400/fixup-icu.sh b/icu/icu4c/as_is/os400/fixup-icu.sh
old mode 100755
new mode 100644
diff --git a/icu/icu4c/as_is/os400/unpax-icu.sh b/icu/icu4c/as_is/os400/unpax-icu.sh
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/common/rbbicst.pl b/icu/icu4c/source/common/rbbicst.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/config/dist-data.sh b/icu/icu4c/source/config/dist-data.sh
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/config/test-icu-config.sh b/icu/icu4c/source/config/test-icu-config.sh
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/configure b/icu/icu4c/source/configure
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/data/unidata/clean.sh b/icu/icu4c/source/data/unidata/clean.sh
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/data/unidata/generate.sh b/icu/icu4c/source/data/unidata/generate.sh
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/i18n/regexcst.pl b/icu/icu4c/source/i18n/regexcst.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/install-sh b/icu/icu4c/source/install-sh
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/runConfigureICU b/icu/icu4c/source/runConfigureICU
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/compat/tzone.pl b/icu/icu4c/source/test/compat/tzone.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/depstest/dependencies.py b/icu/icu4c/source/test/depstest/dependencies.py
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/depstest/depstest.py b/icu/icu4c/source/test/depstest/depstest.py
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/hdrtst/testinternalheaders.sh b/icu/icu4c/source/test/hdrtst/testinternalheaders.sh
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/hdrtst/testtagsguards.sh b/icu/icu4c/source/test/hdrtst/testtagsguards.sh
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/charperf/CharPerf.pl b/icu/icu4c/source/test/perf/charperf/CharPerf.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/charperf/CharPerf_r.pl b/icu/icu4c/source/test/perf/charperf/CharPerf_r.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/collationperf/CollPerf.pl b/icu/icu4c/source/test/perf/collationperf/CollPerf.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/collperf/CollPerf.pl b/icu/icu4c/source/test/perf/collperf/CollPerf.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/collperf/CollPerf_r.pl b/icu/icu4c/source/test/perf/collperf/CollPerf_r.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/collperf2/CollPerf2_r.pl b/icu/icu4c/source/test/perf/collperf2/CollPerf2_r.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/convperf/ConvPerf_r.pl b/icu/icu4c/source/test/perf/convperf/ConvPerf_r.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/convperf/convperf_ansi.pl b/icu/icu4c/source/test/perf/convperf/convperf_ansi.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/convperf/convperf_iml.pl b/icu/icu4c/source/test/perf/convperf/convperf_iml.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/localecanperf/runTest.sh b/icu/icu4c/source/test/perf/localecanperf/runTest.sh
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/normperf/NormPerf.pl b/icu/icu4c/source/test/perf/normperf/NormPerf.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/normperf/NormPerf_r.pl b/icu/icu4c/source/test/perf/normperf/NormPerf_r.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/perldriver/Common.pl.template b/icu/icu4c/source/test/perf/perldriver/Common.pl.template
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/strsrchperf/StrSrchPerf_r.pl b/icu/icu4c/source/test/perf/strsrchperf/StrSrchPerf_r.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/ubrkperf/UBrkPerf_r.pl b/icu/icu4c/source/test/perf/ubrkperf/UBrkPerf_r.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/unisetperf/draft/contperf.bat b/icu/icu4c/source/test/perf/unisetperf/draft/contperf.bat
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/unisetperf/draft/contperf.sh b/icu/icu4c/source/test/perf/unisetperf/draft/contperf.sh
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/unisetperf/draft/span16perf.bat b/icu/icu4c/source/test/perf/unisetperf/draft/span16perf.bat
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/unisetperf/draft/span16perf.sh b/icu/icu4c/source/test/perf/unisetperf/draft/span16perf.sh
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/unisetperf/draft/span8perf.bat b/icu/icu4c/source/test/perf/unisetperf/draft/span8perf.bat
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/unisetperf/draft/span8perf.sh b/icu/icu4c/source/test/perf/unisetperf/draft/span8perf.sh
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/unisetperf/unisetperf.pl b/icu/icu4c/source/test/perf/unisetperf/unisetperf.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/usetperf/UsetPerf.pl b/icu/icu4c/source/test/perf/usetperf/UsetPerf.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/ustrperf/StringPerf.pl b/icu/icu4c/source/test/perf/ustrperf/StringPerf.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/ustrperf/StringPerf_r.pl b/icu/icu4c/source/test/perf/ustrperf/StringPerf_r.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/utfperf/UtfPerf.pl b/icu/icu4c/source/test/perf/utfperf/UtfPerf.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/utrie2perf/utrie2perf.bat b/icu/icu4c/source/test/perf/utrie2perf/utrie2perf.bat
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/test/perf/utrie2perf/utrie2perf.sh b/icu/icu4c/source/test/perf/utrie2perf/utrie2perf.sh
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/tools/genrb/parse.cpp b/icu/icu4c/source/tools/genrb/parse.cpp
index 96fd81a..056fa0e 100644
--- a/icu/icu4c/source/tools/genrb/parse.cpp
+++ b/icu/icu4c/source/tools/genrb/parse.cpp
@@ -1153,7 +1153,7 @@ addCollation(ParseState* state, TableResource  *result, const char *collationTyp
     struct UString    *tokenValue;
     struct UString     comment;
     enum   ETokenType  token;
-    char               subtag[1024];
+    CharString         subtag;
     UnicodeString      rules;
     UBool              haveRules = false;
     UVersionInfo       version;
@@ -1189,7 +1189,8 @@ addCollation(ParseState* state, TableResource  *result, const char *collationTyp
             return NULL;
         }
 
-        u_UCharsToChars(tokenValue->fChars, subtag, u_strlen(tokenValue->fChars) + 1);
+        subtag.clear();
+        subtag.appendInvariantChars(tokenValue->fChars, u_strlen(tokenValue->fChars), *status);
 
         if (U_FAILURE(*status))
         {
@@ -1197,7 +1198,7 @@ addCollation(ParseState* state, TableResource  *result, const char *collationTyp
             return NULL;
         }
 
-        member = parseResource(state, subtag, NULL, status);
+        member = parseResource(state, subtag.data(), NULL, status);
 
         if (U_FAILURE(*status))
         {
@@ -1208,7 +1209,7 @@ addCollation(ParseState* state, TableResource  *result, const char *collationTyp
         {
             // Ignore the parsed resources, continue parsing.
         }
-        else if (uprv_strcmp(subtag, "Version") == 0 && member->isString())
+        else if (uprv_strcmp(subtag.data(), "Version") == 0 && member->isString())
         {
             StringResource *sr = static_cast<StringResource *>(member);
             char     ver[40];
@@ -1225,11 +1226,11 @@ addCollation(ParseState* state, TableResource  *result, const char *collationTyp
             result->add(member, line, *status);
             member = NULL;
         }
-        else if(uprv_strcmp(subtag, "%%CollationBin")==0)
+        else if(uprv_strcmp(subtag.data(), "%%CollationBin")==0)
         {
             /* discard duplicate %%CollationBin if any*/
         }
-        else if (uprv_strcmp(subtag, "Sequence") == 0 && member->isString())
+        else if (uprv_strcmp(subtag.data(), "Sequence") == 0 && member->isString())
         {
             StringResource *sr = static_cast<StringResource *>(member);
             rules = sr->fString;
@@ -1395,7 +1396,7 @@ parseCollationElements(ParseState* state, char *tag, uint32_t startline, UBool n
     struct UString    *tokenValue;
     struct UString     comment;
     enum   ETokenType  token;
-    char               subtag[1024], typeKeyword[1024];
+    CharString         subtag, typeKeyword;
     uint32_t           line;
 
     result = table_open(state->bundle, tag, NULL, status);
@@ -1437,7 +1438,8 @@ parseCollationElements(ParseState* state, char *tag, uint32_t startline, UBool n
                 return NULL;
             }
 
-            u_UCharsToChars(tokenValue->fChars, subtag, u_strlen(tokenValue->fChars) + 1);
+            subtag.clear();
+            subtag.appendInvariantChars(tokenValue->fChars, u_strlen(tokenValue->fChars), *status);
 
             if (U_FAILURE(*status))
             {
@@ -1445,9 +1447,9 @@ parseCollationElements(ParseState* state, char *tag, uint32_t startline, UBool n
                 return NULL;
             }
 
-            if (uprv_strcmp(subtag, "default") == 0)
+            if (uprv_strcmp(subtag.data(), "default") == 0)
             {
-                member = parseResource(state, subtag, NULL, status);
+                member = parseResource(state, subtag.data(), NULL, status);
 
                 if (U_FAILURE(*status))
                 {
@@ -1466,22 +1468,29 @@ parseCollationElements(ParseState* state, char *tag, uint32_t startline, UBool n
                 if(token == TOK_OPEN_BRACE) {
                     token = getToken(state, &tokenValue, &comment, &line, status);
                     TableResource *collationRes;
-                    if (keepCollationType(subtag)) {
-                        collationRes = table_open(state->bundle, subtag, NULL, status);
+                    if (keepCollationType(subtag.data())) {
+                        collationRes = table_open(state->bundle, subtag.data(), NULL, status);
                     } else {
                         collationRes = NULL;
                     }
                     // need to parse the collation data regardless
-                    collationRes = addCollation(state, collationRes, subtag, startline, status);
+                    collationRes = addCollation(state, collationRes, subtag.data(), startline, status);
                     if (collationRes != NULL) {
                         result->add(collationRes, startline, *status);
                     }
                 } else if(token == TOK_COLON) { /* right now, we'll just try to see if we have aliases */
                     /* we could have a table too */
                     token = peekToken(state, 1, &tokenValue, &line, &comment, status);
-                    u_UCharsToChars(tokenValue->fChars, typeKeyword, u_strlen(tokenValue->fChars) + 1);
-                    if(uprv_strcmp(typeKeyword, "alias") == 0) {
-                        member = parseResource(state, subtag, NULL, status);
+                    typeKeyword.clear();
+                    typeKeyword.appendInvariantChars(tokenValue->fChars, u_strlen(tokenValue->fChars), *status);
+                    if (U_FAILURE(*status))
+                    {
+                        res_close(result);
+                        return NULL;
+                    }
+
+                    if(uprv_strcmp(typeKeyword.data(), "alias") == 0) {
+                        member = parseResource(state, subtag.data(), NULL, status);
                         if (U_FAILURE(*status))
                         {
                             res_close(result);
@@ -1523,7 +1532,7 @@ realParseTable(ParseState* state, TableResource *table, char *tag, uint32_t star
     struct UString    *tokenValue=NULL;
     struct UString    comment;
     enum   ETokenType token;
-    char              subtag[1024];
+    CharString        subtag;
     uint32_t          line;
     UBool             readToken = false;
 
@@ -1562,7 +1571,8 @@ realParseTable(ParseState* state, TableResource *table, char *tag, uint32_t star
         }
 
         if(uprv_isInvariantUString(tokenValue->fChars, -1)) {
-            u_UCharsToChars(tokenValue->fChars, subtag, u_strlen(tokenValue->fChars) + 1);
+            subtag.clear();
+            subtag.appendInvariantChars(tokenValue->fChars, u_strlen(tokenValue->fChars), *status);
         } else {
             *status = U_INVALID_FORMAT_ERROR;
             error(line, "invariant characters required for table keys");
@@ -1575,7 +1585,7 @@ realParseTable(ParseState* state, TableResource *table, char *tag, uint32_t star
             return NULL;
         }
 
-        member = parseResource(state, subtag, &comment, status);
+        member = parseResource(state, subtag.data(), &comment, status);
 
         if (member == NULL || U_FAILURE(*status))
         {
diff --git a/icu/icu4c/source/tools/genren/genren.pl b/icu/icu4c/source/tools/genren/genren.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/tools/gensprep/filterRFC3454.pl b/icu/icu4c/source/tools/gensprep/filterRFC3454.pl
old mode 100755
new mode 100644
diff --git a/icu/icu4c/source/tools/memcheck/ICUMemCheck.pl b/icu/icu4c/source/tools/memcheck/ICUMemCheck.pl
old mode 100755
new mode 100644
diff --git a/icu/tools/cldr/lib/install-cldr-jars.sh b/icu/tools/cldr/lib/install-cldr-jars.sh
old mode 100755
new mode 100644
-- 
2.45.4

