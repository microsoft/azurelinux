From 186b3fef5b6938267c1b997ac63108a2938316f7 Mon Sep 17 00:00:00 2001
From: AkarshHCL <v-akarshc@microsoft.com>
Date: Thu, 29 May 2025 05:52:21 +0000
Subject: [PATCH] Address CVE-2025-5244

Upstream Patch reference: https://sourceware.org/git/gitweb.cgi?p=binutils-gdb.git;h=d1458933830456e54223d9fc61f0d9b3a19256f5

---
 bfd/elflink.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/bfd/elflink.c b/bfd/elflink.c
index 30b32bf9..be2a2f53 100644
--- a/bfd/elflink.c
+++ b/bfd/elflink.c
@@ -14120,7 +14120,8 @@ elf_gc_sweep (bfd *abfd, struct bfd_link_info *info)
 	  if (o->flags & SEC_GROUP)
 	    {
 	      asection *first = elf_next_in_group (o);
-	      o->gc_mark = first->gc_mark;
+	      if (first != NULL)
+		o->gc_mark = first->gc_mark;
 	    }
 
 	  if (o->gc_mark)
-- 
2.45.2

