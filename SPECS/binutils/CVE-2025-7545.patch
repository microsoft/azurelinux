From 5ea79aec8f03363778904754b75337f73be0db16 Mon Sep 17 00:00:00 2001
From: Azure Linux Security Servicing Account
 <azurelinux-security@microsoft.com>
Date: Thu, 17 Jul 2025 08:56:14 +0000
Subject: [PATCH] Fix CVE CVE-2025-7545 in binutils

Upstream Patch Reference: https://github.com/bminor/binutils-gdb/commit/08c3cbe5926e4d355b5cb70bbec2b1eeb40c2944.patch
---
 binutils/objcopy.c | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/binutils/objcopy.c b/binutils/objcopy.c
index a6c2e0dc..b9552398 100644
--- a/binutils/objcopy.c
+++ b/binutils/objcopy.c
@@ -4438,6 +4438,7 @@ copy_section (bfd *ibfd, sec_ptr isection, void *obfdarg)
 	  char *to = (char *) memhunk;
 	  char *end = (char *) memhunk + size;
 	  int i;
+	  bfd_size_type memhunk_size = size;
 
 	  /* If the section address is not exactly divisible by the interleave,
 	     then we must bias the from address.  If the copy_byte is less than
@@ -4457,6 +4458,11 @@ copy_section (bfd *ibfd, sec_ptr isection, void *obfdarg)
 	      }
 
 	  size = (size + interleave - 1 - copy_byte) / interleave * copy_width;
+
+	  /* Don't extend the output section size.  */
+	  if (size > memhunk_size)
+	    size = memhunk_size;
+
 	  osection->lma /= interleave;
 	  if (copy_byte < extra)
 	    osection->lma++;
-- 
2.45.3

