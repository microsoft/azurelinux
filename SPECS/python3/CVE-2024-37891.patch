From b512887b5421844c0e4589e36241da5656b65d1b Mon Sep 17 00:00:00 2001
From: Ankita Pareek <ankitapareek@microsoft.com>
Date: Fri, 11 Apr 2025 19:14:27 +0530
Subject: [PATCH] python3: Address CVE-2024-37891 with a patch

Upstream reference: https://github.com/kjd/idna/commit/1d365e17e10d72d0b7876316fc7b9ca0eebdd38d

Signed-off-by: Ankita Pareek <ankitapareek@microsoft.com>
---
 _vendor/urllib3/util/retry.py | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/pip/_vendor/urllib3/util/retry.py b/pip/_vendor/urllib3/util/retry.py
index 4bc4fb0..392553b 100644
--- a/pip/_vendor/urllib3/util/retry.py
+++ b/pip/_vendor/urllib3/util/retry.py
@@ -235,7 +235,9 @@ class Retry(object):
     RETRY_AFTER_STATUS_CODES = frozenset([413, 429, 503])
 
     #: Default headers to be used for ``remove_headers_on_redirect``
-    DEFAULT_REMOVE_HEADERS_ON_REDIRECT = frozenset(["Cookie","Authorization"])
+    DEFAULT_REMOVE_HEADERS_ON_REDIRECT = frozenset(
+        ["Cookie","Authorization", "Proxy-Authorization"]
+    )
 
     #: Maximum backoff time.
     DEFAULT_BACKOFF_MAX = 120
-- 
2.34.1

