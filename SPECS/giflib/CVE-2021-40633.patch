From 7e6036db1536e0972de6f8f4e1fcf827d313f8ea Mon Sep 17 00:00:00 2001
From: Kanishk-Bansal <kbkanishk975@gmail.com>
Date: Mon, 21 Apr 2025 19:53:54 +0000
Subject: [PATCH] Address CVE-2021-40633

Upstream Patch Reference : https://sourceforge.net/p/giflib/code/ci/ccbc956432650734c91acb3fc88837f7b81267ff

Signed-off-by: Kanishk-Bansal <kbkanishk975@gmail.com>
---
 gif2rgb.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/gif2rgb.c b/gif2rgb.c
index 11c39e4..855f821 100644
--- a/gif2rgb.c
+++ b/gif2rgb.c
@@ -496,6 +496,10 @@ static void GIF2RGB(int NumFiles, char *FileName,
 		   ScreenBuffer, 
 		   GifFile->SWidth, GifFile->SHeight);
 
+	for (i = 0; i < GifFile->SHeight; i++) {
+		(void)free(ScreenBuffer[i]);
+	}
+
     (void)free(ScreenBuffer);
 
     if (DGifCloseFile(GifFile, &Error) == GIF_ERROR) {
-- 
2.45.2

