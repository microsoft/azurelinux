commit 7e4d5dabe7a9b754c601f214e65b544e67ba9f59
Author: Up-wind <lj.upwind@gmail.com>
Date:   Mon Mar 25 20:07:11 2024 +0800

    Add NULL check to cJSON_SetValuestring()
    
    If the valuestring passed to cJSON_SetValuestring is NULL, a null pointer dereference will happen.
    
    This commit adds the NULL check of valuestring before it is dereferenced.

---
 binutils/cJSON.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/binutils/cJSON.c b/binutils/cJSON.c
index 541934c..e85ac11 100644
--- a/binutils/cJSON.c
+++ b/binutils/cJSON.c
@@ -393,6 +393,7 @@ CJSON_PUBLIC(double) cJSON_SetNumberHelper(cJSON *object, double number)
     return object->valuedouble = number;
 }
 
+/* Note: when passing a NULL valuestring, cJSON_SetValuestring treats this as an error and return NULL */
 CJSON_PUBLIC(char*) cJSON_SetValuestring(cJSON *object, const char *valuestring)
 {
     char *copy = NULL;
@@ -401,8 +402,8 @@ CJSON_PUBLIC(char*) cJSON_SetValuestring(cJSON *object, const char *valuestring)
     {
         return NULL;
     }
-    /* return NULL if the object is corrupted */
-    if (object->valuestring == NULL)
+    /* return NULL if the object is corrupted or valuestring is NULL */
+    if (object->valuestring == NULL || valuestring == NULL)
     {
         return NULL;
     }
-- 
2.25.1

