From 1dfb03ca74b78ff4a87b48a70b91a5cfc985f9c4 Mon Sep 17 00:00:00 2001
From: dj_palli <v-dpalli@microsoft.com>
Date: Thu, 12 Jun 2025 20:49:56 +0000
Subject: [PATCH] Address CVE-2023-53154

Upstream Patch Reference: https://github.com/DaveGamble/cJSON/commit/3ef4e4e730e5efd381be612df41e1ff3f5bb3c32

---
 binutils/cJSON.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/binutils/cJSON.c b/binutils/cJSON.c
index e85ac11..45c1c45 100644
--- a/binutils/cJSON.c
+++ b/binutils/cJSON.c
@@ -1650,6 +1650,11 @@ static cJSON_bool parse_object(cJSON * const item, parse_buffer * const input_bu
             current_item = new_item;
         }
 
+	if (cannot_access_at_index(input_buffer, 1))
+        {
+            goto fail; /* nothing comes after the comma */
+        }
+
         /* parse the name of the child */
         input_buffer->offset++;
         buffer_skip_whitespace(input_buffer);
-- 
2.45.2

