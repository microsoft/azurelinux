From e3a08a2f1d4925f3903adb501f1665b9f6c97a61 Mon Sep 17 00:00:00 2001
From: Azure Linux Security Servicing Account
 <azurelinux-security@microsoft.com>
Date: Thu, 24 Jul 2025 10:40:19 +0000
Subject: [PATCH] Fix CVE CVE-2025-48060 in jq

[AI Backported] Upstream Patch Reference: https://github.com/jqlang/jq/commit/c6e041699d8cd31b97375a2596217aff2cfca85b
---
 src/jv.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/jv.c b/src/jv.c
index d3042e6..d7e3938 100644
--- a/src/jv.c
+++ b/src/jv.c
@@ -498,6 +498,7 @@ static jv jvp_string_empty_new(uint32_t length) {
   jvp_string* s = jvp_string_alloc(length);
   s->length_hashed = 0;
   memset(s->data, 0, length);
+  s->data[length] = 0;
   jv r = {JV_KIND_STRING, 0, 0, 0, {&s->refcnt}};
   return r;
 }
-- 
2.45.4

