From 4ec197b7cf349460ed797ec60f5d6ce1060d5682 Mon Sep 17 00:00:00 2001
From: Azure Linux Security Servicing Account
 <azurelinux-security@microsoft.com>
Date: Tue, 1 Jul 2025 11:13:08 +0000
Subject: [PATCH] Fix CVE CVE-2025-6199 in gdk-pixbuf2

[AI Backported] Upstream Patch Reference: https://gitlab.gnome.org/GNOME/gdk-pixbuf/-/merge_requests/191/diffs?commit_id=c4986342b241cdc075259565f3fa7a7597d32a32
---
 gdk-pixbuf/lzw.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/gdk-pixbuf/lzw.c b/gdk-pixbuf/lzw.c
index 9e052a6..2ea9a63 100644
--- a/gdk-pixbuf/lzw.c
+++ b/gdk-pixbuf/lzw.c
@@ -200,7 +200,7 @@ lzw_decoder_feed (LZWDecoder *self,
                                         else {
                                                 /* Invalid code received - just stop here */
                                                 self->last_code = self->eoi_code;
-                                                return output_length;
+                                                return n_written;
                                         }
 
                                         /* When table is full increase code size */
-- 
2.45.3

