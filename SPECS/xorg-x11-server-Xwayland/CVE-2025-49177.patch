From fec15c9463b629600306a25fb01801353b6a9bf6 Mon Sep 17 00:00:00 2001
From: Kevin Lockwood <v-klockwood@microsoft.com>
Date: Mon, 23 Jun 2025 15:22:44 -0700
Subject: [PATCH] [Medium] Patch xorg-x11-server-Xwayland for CVE-2025-49177

Upstream Patch Link: https://gitlab.freedesktop.org/xorg/xserver/-/commit/ab02fb96b1c701c3bb47617d965522c34befa6af.patch

Part-of: <https://gitlab.freedesktop.org/xorg/xserver/-/merge_requests/2024>

Only edit to the upstream patch was because the patcher could not find
where to position a hunk
---
 xfixes/disconnect.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/xfixes/disconnect.c b/xfixes/disconnect.c
index e412942..b3529af 100644
--- a/xfixes/disconnect.c
+++ b/xfixes/disconnect.c
@@ -69,6 +69,7 @@ ProcXFixesSetClientDisconnectMode(ClientPtr client)
     ClientDisconnectPtr pDisconnect = GetClientDisconnect(client);
 
     REQUEST(xXFixesSetClientDisconnectModeReq);
+    REQUEST_SIZE_MATCH(xXFixesSetClientDisconnectModeReq);
 
     pDisconnect->disconnect_mode = stuff->disconnect_mode;
 
@@ -82,7 +83,7 @@ SProcXFixesSetClientDisconnectMode(ClientPtr client)
 
     swaps(&stuff->length);
 
-    REQUEST_AT_LEAST_SIZE(xXFixesSetClientDisconnectModeReq);
+    REQUEST_SIZE_MATCH(xXFixesSetClientDisconnectModeReq);
 
     swapl(&stuff->disconnect_mode);
 
-- 
2.34.1

