From 6a15c7c2cd5638c9c359e308fc503860b0a3c857 Mon Sep 17 00:00:00 2001
From: Mayank Singh <mayansingh@microsoft.com>
Date: Tue, 25 Feb 2025 03:12:13 +0000
Subject: [PATCH] Address CVE-2025-0633
Upstream Reference Link: https://gitlab.com/iniparser/iniparser/-/commit/072a39a772a38c475e35a1be311304ca99e9de7f

---
 src/iniparser.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/iniparser.c b/src/iniparser.c
index fffdf9f..62febeb 100644
--- a/src/iniparser.c
+++ b/src/iniparser.c
@@ -301,6 +301,7 @@ void iniparser_dumpsection_ini(const dictionary * d, const char * s, FILE * f)
 
     if (d==NULL || f==NULL) return ;
     if (! iniparser_find_entry(d, s)) return ;
+    if (strlen(s) > sizeof(keym)) return;
 
     seclen  = (int)strlen(s);
     fprintf(f, "\n[%s]\n", s);
-- 
2.45.3

