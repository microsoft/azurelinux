From 2837e3b258d69998d1b0f9472fcd5cbc63c379c1 Mon Sep 17 00:00:00 2001
From: Sudipta Pandit <sudpandit@microsoft.com>
Date: Fri, 15 Nov 2024 23:35:44 +0530
Subject: [PATCH] Fix CVE-2020-28458

Reference: https://github.com/DataTables/DataTablesSrc/commit/a51cbe99fd3d02aa5582f97d4af1615d11a1ea03
---
 datatables/media/js/jquery.dataTables.js | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/src/ui/bower_components/datatables/media/js/jquery.dataTables.js b/src/ui/bower_components/datatables/media/js/jquery.dataTables.js
index aeb7fb9..6800c2d 100644
--- a/src/ui/bower_components/datatables/media/js/jquery.dataTables.js
+++ b/src/ui/bower_components/datatables/media/js/jquery.dataTables.js
@@ -2732,6 +2732,11 @@
 	
 				for ( var i=0, iLen=a.length-1 ; i<iLen ; i++ )
 				{
+          // Protect against prototype pollution
+          if (a[i] === '__proto__' || a[i] === 'constructor') {
+					  throw new Error('Cannot set prototype values');
+				  }
+
 					// Check if we are dealing with an array notation request
 					arrayNotation = a[i].match(__reArray);
 					funcNotation = a[i].match(__reFn);
-- 
2.34.1

