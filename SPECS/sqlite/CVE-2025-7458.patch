From 7b06377c3e3ec165a0024b3950ae71b39e7bfcc7 Mon Sep 17 00:00:00 2001
From: Kshitiz Godara <kgodara@microsoft.com>
Date: Sun, 3 Aug 2025 16:51:50 +0000
Subject: [PATCH 1/2] Fix for CVE-2025-7458 [MEDIUM]

Upstream reference:
https://sqlite.org/src/info/12ad822d9b827777
---
 sqlite3.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/sqlite3.c b/sqlite3.c
index 158d416..70c9b45 100644
--- a/sqlite3.c
+++ b/sqlite3.c
@@ -158940,6 +158940,10 @@ static int wherePathSolver(WhereInfo *pWInfo, LogEst nRowEst){
       if( pFrom->isOrdered==pWInfo->pOrderBy->nExpr ){
         pWInfo->eDistinct = WHERE_DISTINCT_ORDERED;
       }
+      if( pWInfo->pOrderBy
+       && pWInfo->nOBSat > pWInfo->pOrderBy->nExpr ){
+        pWInfo->nOBSat = pWInfo->pOrderBy->nExpr;
+      }
     }else{
       pWInfo->revMask = pFrom->revLoop;
       if( pWInfo->nOBSat<=0 ){
-- 
2.45.4

