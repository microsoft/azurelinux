backport of https://sourceware.org/git?p=glibc.git;a=commit;h=17092c0311f954e6f3c010f73ce3a78c24ac279a

diff -ru glibc-2.38-orig/sysdeps/posix/getaddrinfo.c glibc-2.38/sysdeps/posix/getaddrinfo.c
--- glibc-2.38-orig/sysdeps/posix/getaddrinfo.c	2024-06-17 21:53:25.432414431 +0000
+++ glibc-2.38/sysdeps/posix/getaddrinfo.c	2024-06-17 23:44:56.127284457 +0000
@@ -1187,9 +1187,7 @@
   if (malloc_name)
     free ((char *) name);
   free (addrmem);
-  if (res.free_at)
-    free (res.at);
-  free (res.canon);
+  gaih_result_reset (&res);
 
   return result;
 }
