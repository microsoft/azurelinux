From 65e18c2c973e15dc3b85b2f4a11f9be7b191a085 Mon Sep 17 00:00:00 2001
From: Sreenivasulu Malavathula <v-smalavathu@microsoft.com>
Date: Mon, 14 Apr 2025 17:41:16 -0500
Subject: [PATCH] Address CVE-2025-32464
Upstream Patch Reference: https://github.com/haproxy/haproxy/commit/3e3b9eebf871510aee36c3a3336faac2f38c9559

---
 src/sample.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/sample.c b/src/sample.c
index de76701..a7b6b16 100644
--- a/src/sample.c
+++ b/src/sample.c
@@ -3130,7 +3130,7 @@ static int sample_conv_regsub(const struct arg *arg_p, struct sample *smp, void
 		output->data = exp_replace(output->area, output->size, start, arg_p[1].data.str.area, pmatch);
 
 		/* replace the matching part */
-		max = output->size - output->data;
+		max = trash->size - trash->data;
 		if (max) {
 			if (max > output->data)
 				max = output->data;
-- 
2.45.2

