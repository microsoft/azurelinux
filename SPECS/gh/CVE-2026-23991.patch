From c00a0f0b748c1e42e9ffc4768d9c9ff90ac99d05 Mon Sep 17 00:00:00 2001
From: AllSpark <allspark@microsoft.com>
Date: Mon, 26 Jan 2026 19:57:27 +0000
Subject: [PATCH] Perform type assertion (#710)

* Perform type assertion

Signed-off-by: Fredrik Skogman <kommendorkapten@github.com>

* Correct error type

Signed-off-by: Fredrik Skogman <kommendorkapten@github.com>

---------

Signed-off-by: Fredrik Skogman <kommendorkapten@github.com>
Signed-off-by: Azure Linux Security Servicing Account <azurelinux-security@microsoft.com>
Upstream-reference: AI Backport of https://github.com/theupdateframework/go-tuf/commit/73345ab6b0eb7e59d525dac17a428f043074cef6.patch
---
 .../theupdateframework/go-tuf/v2/metadata/metadata.go    | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

diff --git a/vendor/github.com/theupdateframework/go-tuf/v2/metadata/metadata.go b/vendor/github.com/theupdateframework/go-tuf/v2/metadata/metadata.go
index 3e0a9e1..6d9fbc5 100644
--- a/vendor/github.com/theupdateframework/go-tuf/v2/metadata/metadata.go
+++ b/vendor/github.com/theupdateframework/go-tuf/v2/metadata/metadata.go
@@ -896,7 +896,14 @@ func checkType[T Roles](data []byte) error {
 	if err := json.Unmarshal(data, &m); err != nil {
 		return err
 	}
-	signedType := m["signed"].(map[string]any)["_type"].(string)
+	signed, ok := m["signed"].(map[string]any)
+	if !ok {
+		return &ErrValue{Msg: "metadata 'signed' field is missing or not an object"}
+	}
+	signedType, ok := signed["_type"].(string)
+	if !ok {
+		return &ErrValue{Msg: "no _type found in signed"}
+	}
 	switch i.(type) {
 	case *RootType:
 		if ROOT != signedType {
-- 
2.45.4

