# CVE-2023-4641: gpasswd: memory leak in getpass() function
# Backport fix from https://github.com/shadow-maint/shadow/commit/65c88a43a23c2391dcc90c0abda3e839e9c57904
# Signed-off-by: Archana Choudhary <archana1@microsoft.com>
--- a/src/gpasswd.c	2021-07-22 21:50:51.000000000 +0000
+++ b/src/gpasswd.c	2025-04-14 13:34:13.478082742 +0000
@@ -919,6 +919,7 @@
 		strzero (cp);
 		cp = getpass (_("Re-enter new password: "));
 		if (NULL == cp) {
+			memzero (pass, sizeof pass);
 			exit (1);
 		}
