diff -ru cmake-3.28.2-orig/Utilities/cmlibuv/src/idna.c cmake-3.28.2/Utilities/cmlibuv/src/idna.c
--- cmake-3.28.2-orig/Utilities/cmlibuv/src/idna.c	2024-05-30 19:45:42.491785489 +0000
+++ cmake-3.28.2/Utilities/cmlibuv/src/idna.c	2024-05-30 20:14:58.900157528 +0000
@@ -274,6 +274,9 @@
   char* ds;
   int rc;
 
+  if (s == se)
+    return UV_EINVAL;
+
   ds = d;
 
   si = s;
@@ -308,8 +311,10 @@
       return rc;
   }
 
-  if (d < de)
-    *d++ = '\0';
+  if (d >= de)
+    return UV_EINVAL;
+
+  *d++ = '\0';
 
   return d - ds;  /* Number of bytes written. */
 }
