From 19c67d35287ca30929e0f4353cdc1b89de1ae75e Mon Sep 17 00:00:00 2001
From: AllSpark <allspark@microsoft.com>
Date: Mon, 12 Jan 2026 16:41:34 +0000
Subject: [PATCH] Fix for CVE-2025-13151: prevent stack-based buffer overflow
 in asn1_expand_octet_string; update NEWS

Signed-off-by: Azure Linux Security Servicing Account <azurelinux-security@microsoft.com>
Upstream-reference: AI Backport of https://gitlab.com/gnutls/libtasn1/-/commit/d276cc495a2a32b182c3c39851f1ba58f2d9f9b8.patch
---
 NEWS           | 1 +
 lib/decoding.c | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/NEWS b/NEWS
index cbd09eb..2100e6f 100644
--- a/NEWS
+++ b/NEWS
@@ -4,6 +4,7 @@ GNU Libtasn1 NEWS                                     -*- outline -*-
 - Clarify libtasn1.map license.  Closes: #38.
 - Fix ETYPE_OK out of bounds read.  Closes: #32.
 - Update gnulib files and various maintenance fixes.
+- Fix for vulnerbaility CVE-2025-13151 Stack-based buffer overflow
 
 * Noteworthy changes in release 4.18.0 (2021-11-09) [stable]
 - Improve GTK-DOC manual.  Closes: #35.
diff --git a/lib/decoding.c b/lib/decoding.c
index b9245c4..bc45138 100644
--- a/lib/decoding.c
+++ b/lib/decoding.c
@@ -1976,7 +1976,7 @@ int
 asn1_expand_octet_string (asn1_node_const definitions, asn1_node * element,
 			  const char *octetName, const char *objectName)
 {
-  char name[2 * ASN1_MAX_NAME_SIZE + 1], value[ASN1_MAX_NAME_SIZE];
+  char name[2 * ASN1_MAX_NAME_SIZE + 2], value[ASN1_MAX_NAME_SIZE];
   int retCode = ASN1_SUCCESS, result;
   int len, len2, len3;
   asn1_node_const p2;
-- 
2.45.4

