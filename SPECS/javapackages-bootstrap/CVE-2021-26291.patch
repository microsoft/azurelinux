From 3291b840445ecc468bddf6dbb4d782b9b79146b7 Mon Sep 17 00:00:00 2001
From: mkoncek <marian.koncek@mailbox.org>
Date: Fri, 17 Dec 2021 12:45:52 +0100
Subject: [PATCH] Update maven to 3.8.4

---
 mbi/dist/metadata.txt                         |  1 +
 .../0003-Port-to-maven-3.8.1.patch            | 59 +++++++++++++++++++
 .../0003-Port-to-maven-3.8.1.patch            | 33 +++++++++++
 project/maven.properties                      |  2 +-
 project/maven.xml                             |  4 +-
 5 files changed, 97 insertions(+), 2 deletions(-)
 create mode 100644 patches/maven-artifact-transfer/0003-Port-to-maven-3.8.1.patch
 create mode 100644 patches/maven-plugin-testing/0003-Port-to-maven-3.8.1.patch

diff --git a/mbi/dist/metadata.txt b/mbi/dist/metadata.txt
index 90f4c62..8f4d49c 100644
--- a/mbi/dist/metadata.txt
+++ b/mbi/dist/metadata.txt
@@ -328,6 +328,7 @@ MOD maven-core
     DEP org.codehaus.plexus plexus-classworlds
     DEP org.codehaus.plexus plexus-component-annotations
     DEP org.apache.commons commons-lang3
+    DEP org.slf4j slf4j-api
 MOD maven-dependency-analyzer
   ART org.apache.maven.shared maven-dependency-analyzer
     DEP org.ow2.asm asm
diff --git a/patches/maven-artifact-transfer/0003-Port-to-maven-3.8.1.patch b/patches/maven-artifact-transfer/0003-Port-to-maven-3.8.1.patch
new file mode 100644
index 0000000..afeef3c
--- /dev/null
+++ b/patches/maven-artifact-transfer/0003-Port-to-maven-3.8.1.patch
@@ -0,0 +1,59 @@
+From 801cdd23a9dd9e8948f516537b0f5f09a252c5b7 Mon Sep 17 00:00:00 2001
+From: Marian Koncek <mkoncek@redhat.com>
+Date: Fri, 17 Dec 2021 13:33:49 +0100
+Subject: [PATCH] Port to maven 3.8.1
+
+---
+ .../internal/Maven31ArtifactRepositoryAdapter.java   | 12 ++++++++++++
+ .../internal/Maven31ArtifactRepositoryAdapter.java   | 12 ++++++++++++
+ 2 files changed, 24 insertions(+)
+
+diff --git a/src/main/java/org/apache/maven/shared/transfer/collection/internal/Maven31ArtifactRepositoryAdapter.java b/src/main/java/org/apache/maven/shared/transfer/collection/internal/Maven31ArtifactRepositoryAdapter.java
+index 9d93f31..8297fdb 100644
+--- a/src/main/java/org/apache/maven/shared/transfer/collection/internal/Maven31ArtifactRepositoryAdapter.java
++++ b/src/main/java/org/apache/maven/shared/transfer/collection/internal/Maven31ArtifactRepositoryAdapter.java
+@@ -207,6 +207,18 @@ class Maven31ArtifactRepositoryAdapter implements ArtifactRepository
+         throw new UnsupportedOperationException();
+     }
+ 
++    @Override
++    public boolean isBlocked()
++    {
++        throw new UnsupportedOperationException();
++    }
++
++    @Override
++    public void setBlocked(boolean blocked)
++    {
++        throw new UnsupportedOperationException();
++    }
++
+     @Override
+     public String toString()
+     {
+diff --git a/src/main/java/org/apache/maven/shared/transfer/dependencies/collect/internal/Maven31ArtifactRepositoryAdapter.java b/src/main/java/org/apache/maven/shared/transfer/dependencies/collect/internal/Maven31ArtifactRepositoryAdapter.java
+index d5716bb..4669353 100644
+--- a/src/main/java/org/apache/maven/shared/transfer/dependencies/collect/internal/Maven31ArtifactRepositoryAdapter.java
++++ b/src/main/java/org/apache/maven/shared/transfer/dependencies/collect/internal/Maven31ArtifactRepositoryAdapter.java
+@@ -207,6 +207,18 @@ class Maven31ArtifactRepositoryAdapter implements ArtifactRepository
+         throw new UnsupportedOperationException();
+     }
+ 
++    @Override
++    public boolean isBlocked()
++    {
++        throw new UnsupportedOperationException();
++    }
++
++    @Override
++    public void setBlocked(boolean blocked)
++    {
++        throw new UnsupportedOperationException();
++    }
++
+     @Override
+     public String toString()
+     {
+-- 
+2.31.1
+
diff --git a/patches/maven-plugin-testing/0003-Port-to-maven-3.8.1.patch b/patches/maven-plugin-testing/0003-Port-to-maven-3.8.1.patch
new file mode 100644
index 0000000..2786be2
--- /dev/null
+++ b/patches/maven-plugin-testing/0003-Port-to-maven-3.8.1.patch
@@ -0,0 +1,33 @@
+From 4dc38f384dab2d825e1ab6f7df018650b6aeded1 Mon Sep 17 00:00:00 2001
+From: Marian Koncek <mkoncek@redhat.com>
+Date: Fri, 17 Dec 2021 13:42:11 +0100
+Subject: [PATCH] Port to maven 3.8.1
+
+---
+ .../plugin/testing/stubs/StubArtifactRepository.java | 12 ++++++++++++
+ 1 file changed, 12 insertions(+)
+
+diff --git a/maven-plugin-testing-harness/src/main/java/org/apache/maven/plugin/testing/stubs/StubArtifactRepository.java b/maven-plugin-testing-harness/src/main/java/org/apache/maven/plugin/testing/stubs/StubArtifactRepository.java
+index 9a435b7..c13c3a8 100644
+--- a/maven-plugin-testing-harness/src/main/java/org/apache/maven/plugin/testing/stubs/StubArtifactRepository.java
++++ b/maven-plugin-testing-harness/src/main/java/org/apache/maven/plugin/testing/stubs/StubArtifactRepository.java
+@@ -247,4 +247,16 @@ public class StubArtifactRepository
+     {
+         // no op
+     }
++
++    @Override
++    public boolean isBlocked()
++    {
++        throw new UnsupportedOperationException();
++    }
++
++    @Override
++    public void setBlocked(boolean blocked)
++    {
++        throw new UnsupportedOperationException();
++    }
+ }
+-- 
+2.31.1
+
diff --git a/project/maven.properties b/project/maven.properties
index e5a3c6b..b6ddc64 100644
--- a/project/maven.properties
+++ b/project/maven.properties
@@ -1,3 +1,3 @@
 url=https://github.com/apache/maven.git
 ref=maven-@.@.@
-version=3.6.3
+version=3.8.1
diff --git a/project/maven.xml b/project/maven.xml
index 508bfb1..664f79b 100644
--- a/project/maven.xml
+++ b/project/maven.xml
@@ -82,6 +82,7 @@
     <dependency>maven-shared-utils</dependency>
     <dependency>commons-lang</dependency>
     <dependency>maven-resolver-provider</dependency>
+    <dependency>slf4j</dependency>
     <build>
       <modello>
         <model>src/main/mdo/toolchains.mdo</model>
@@ -214,6 +215,7 @@
     <dependency>maven-model-builder</dependency>
     <dependency>guice</dependency>
     <dependency>maven-builder-support</dependency>
+    <dependency>slf4j</dependency>
     <build>
       <compiler>
         <addSourceRoot>src/main/java</addSourceRoot>
@@ -244,7 +246,7 @@
     <build>
       <modello>
         <model>src/main/mdo/settings.mdo</model>
-        <version>1.1.0</version>
+        <version>1.2.0</version>
         <output>java|xpp3-reader|xpp3-writer</output>
       </modello>
       <compiler>
From bd8826af4fd489a5d6ed117173904f02775415ee Mon Sep 17 00:00:00 2001
From: Sindhu Karri <lakarri@microsoft.com>
Date: Thu, 25 Jul 2024 11:33:17 +0000
Subject: [PATCH] Maven resolver patch

---
 project/maven-resolver.xml | 1 +
 1 file changed, 1 insertion(+)

diff --git a/project/maven-resolver.xml b/project/maven-resolver.xml
index 9f23efc..a08fc61 100644
--- a/project/maven-resolver.xml
+++ b/project/maven-resolver.xml
@@ -20,6 +20,7 @@
         <addSourceRoot>maven-resolver-util/src/main/java</addSourceRoot>
         <addSourceRoot>maven-resolver-connector-basic/src/main/java</addSourceRoot>
         <addSourceRoot>maven-resolver-transport-wagon/src/main/java</addSourceRoot>
+        <addSourceRoot>maven-resolver-named-locks/src/main/java</addSourceRoot>
       </compiler>
       <cdc/>
     </build>
-- 
2.33.8

From b23d2957440cb4ff06a289b4864f782794b45f52 Mon Sep 17 00:00:00 2001
From: Marian Koncek <mkoncek@redhat.com>
Date: Fri, 17 Dec 2021 13:05:49 +0100
Subject: [PATCH] Port to maven-resolver 1.7.2

---
 .../org/apache/maven/repository/internal/MavenAetherModule.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/downstream/maven/maven-resolver-provider/src/main/java/org/apache/maven/repository/internal/MavenAetherModule.java b/downstream/maven/maven-resolver-provider/src/main/java/org/apache/maven/repository/internal/MavenAetherModule.java
index 41e98aaea..d72e3c0f3 100644
--- a/downstream/maven/maven-resolver-provider/src/main/java/org/apache/maven/repository/internal/MavenAetherModule.java
+++ b/downstream/maven/maven-resolver-provider/src/main/java/org/apache/maven/repository/internal/MavenAetherModule.java
@@ -28,7 +28,7 @@
 
 import org.apache.maven.model.building.DefaultModelBuilderFactory;
 import org.apache.maven.model.building.ModelBuilder;
-import org.eclipse.aether.impl.AetherModule;
+import org.eclipse.aether.impl.guice.AetherModule;
 import org.eclipse.aether.impl.ArtifactDescriptorReader;
 import org.eclipse.aether.impl.MetadataGeneratorFactory;
 import org.eclipse.aether.impl.VersionRangeResolver;
-- 
2.31.1
