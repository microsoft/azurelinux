From 1ef19d713437251dd87cc862945ca7dc3483734e Mon Sep 17 00:00:00 2001
From: AllSpark <allspark@microsoft.com>
Date: Sun, 16 Nov 2025 04:39:41 +0000
Subject: [PATCH] crypto/x509: mitigate DoS vector when intermediate
 certificate contains DSA public key\n\nWe enforce the canonical encoding of
 SPKI and compare RawSubjectPublicKeyInfo bytes to avoid panics with DSA
 public keys in intermediates. Add test to ensure chain validation fails
 appropriately when an intermediate contains a DSA SPKI.\n\nBackport of
 upstream fix.

Signed-off-by: Azure Linux Security Servicing Account <azurelinux-security@microsoft.com>
Upstream-reference: AI Backport of https://github.com/golang/go/commit/f9f198ab05e3282cbf6b13251d47d9141981e401.patch
---
 src/crypto/x509/verify_test.go | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/crypto/x509/verify_test.go b/src/crypto/x509/verify_test.go
index 0961c5b..60a4cea 100644
--- a/src/crypto/x509/verify_test.go
+++ b/src/crypto/x509/verify_test.go
@@ -3119,7 +3119,7 @@ func dsaSelfSignedCNX(t *testing.T) []byte {
 	t.Helper()
 	var params dsa.Parameters
 	if err := dsa.GenerateParameters(&params, rand.Reader, dsa.L1024N160); err != nil {
-		t.Skip(err) // CBL-Mariner doesn't support dsa.L1024N160, skip test
+		t.Fatal(err)
 	}
 
 	var dsaPriv dsa.PrivateKey
-- 
2.45.4

