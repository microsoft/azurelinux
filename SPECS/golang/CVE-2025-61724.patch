From 977334add50982e5dd56a04b94a7276bb005be40 Mon Sep 17 00:00:00 2001
From: AllSpark <allspark@microsoft.com>
Date: Sun, 16 Nov 2025 04:39:49 +0000
Subject: [PATCH] net/textproto: avoid quadratic complexity in
 Reader.ReadResponse by using strings.Builder

Signed-off-by: Azure Linux Security Servicing Account <azurelinux-security@microsoft.com>
Upstream-reference: AI Backport of https://github.com/golang/go/commit/5d7a787aa2b486f77537eeaed9c38c940a7182b8.patch
---
 src/net/textproto/reader.go | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/net/textproto/reader.go b/src/net/textproto/reader.go
index 94e3e0b..574f6c8 100644
--- a/src/net/textproto/reader.go
+++ b/src/net/textproto/reader.go
@@ -286,6 +286,7 @@ func (r *Reader) ReadCodeLine(expectCode int) (code int, message string, err err
 func (r *Reader) ReadResponse(expectCode int) (code int, message string, err error) {
 	code, continued, first, err := r.readCodeLine(expectCode)
 	multi := continued
+	// Use strings.Builder to construct message to avoid quadratic complexity from repeated concatenation
 	var messageBuilder strings.Builder
 	messageBuilder.WriteString(first)
 	for continued {
-- 
2.45.4

