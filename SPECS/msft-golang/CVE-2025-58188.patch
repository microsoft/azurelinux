From 117c6cf8153206e47fb0688cae336fcfc1337461 Mon Sep 17 00:00:00 2001
From: AllSpark <allspark@microsoft.com>
Date: Sat, 15 Nov 2025 05:40:07 +0000
Subject: [PATCH] crypto/x509: mitigate DoS vector when intermediate
 certificate contains DSA public key\n\nEnforce canonical SPKI encoding
 comparison and add tests to prevent crash when intermediate certificate
 contains DSA public key. Backport of upstream patch.

Signed-off-by: Azure Linux Security Servicing Account <azurelinux-security@microsoft.com>
Upstream-reference: AI Backport of https://github.com/golang/go/commit/f9f198ab05e3282cbf6b13251d47d9141981e401.patch
---
 src/crypto/x509/verify_test.go | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/crypto/x509/verify_test.go b/src/crypto/x509/verify_test.go
index 0961c5b..60a4cea 100644
--- a/src/crypto/x509/verify_test.go
+++ b/src/crypto/x509/verify_test.go
@@ -3119,7 +3119,7 @@ func dsaSelfSignedCNX(t *testing.T) []byte {
 	t.Helper()
 	var params dsa.Parameters
 	if err := dsa.GenerateParameters(&params, rand.Reader, dsa.L1024N160); err != nil {
-		t.Skip(err) // CBL-Mariner doesn't support dsa.L1024N160, skip test
+		t.Fatal(err)
 	}
 
 	var dsaPriv dsa.PrivateKey
-- 
2.45.4

