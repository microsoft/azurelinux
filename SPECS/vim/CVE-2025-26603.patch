From c3e55ce51cef3a3292b2431bf6f5a9026eb410a7 Mon Sep 17 00:00:00 2001
From: Kanishk-Bansal <kbkanishk975@gmail.com>
Date: Sat, 22 Feb 2025 21:53:16 +0000
Subject: [PATCH] CVE-2025-26603

Upstream Reference : https://github.com/vim/vim/commit/c0f0e2380e5954f4a52a131bf6b8
---
 src/register.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/register.c b/src/register.c
index 47ed218..26fbc27 100644
--- a/src/register.c
+++ b/src/register.c
@@ -2356,7 +2356,8 @@ ex_display(exarg_T *eap)
 
 #ifdef FEAT_EVAL
 	if (name == MB_TOLOWER(redir_reg)
-		|| (redir_reg == '"' && yb == y_previous))
+		|| (vim_strchr((char_u *)"\"*+", redir_reg) != NULL &&
+		    (yb == y_previous || yb == &y_regs[0])))
 	    continue;	    // do not list register being written to, the
 			    // pointer can be freed
 #endif
-- 
2.45.2

