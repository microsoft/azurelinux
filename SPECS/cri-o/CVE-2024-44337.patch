# From: Archana Choudhary <archana1@microsoft.com>
# Date: Wed, 9 Oct 2024 09:54:22 -0400
# Subject: [PATCH] Fixes CVE-2024-44337
# Backported(fixed fuzzing) from the original patch by Krzysztof Kowalczyk <kkowalczyk@gmail.com>
# Source: https://github.com/gomarkdown/markdown/commit/a2a9c4f76ef5a5c32108e36f7c47f8d310322252

--- a/vendor/github.com/gomarkdown/markdown/parser/block.go.orig	2021-04-26 00:00:00.000000000 +0000
+++ b/vendor/github.com/gomarkdown/markdown/parser/block.go	2024-11-06 09:25:11.349954099 +0000
@@ -1825,7 +1825,9 @@
 			if p.extensions&DefinitionLists != 0 {
 				if i < len(data)-1 && data[i+1] == ':' {
 					listLen := p.list(data[prev:], ast.ListTypeDefinition, 0)
-					return prev + listLen
+					if listLen > 0 {
+						return prev + listLen
+					}
 				}
 			}
 
