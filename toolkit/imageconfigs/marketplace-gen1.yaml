storage:
  bootType: legacy

  disks:
  - partitionTableType: gpt
    maxSize: 5000M
    partitions:
    - id: reserved
      type: bios-grub
      start: 1M
      end: 9M

    - id: boot
      type: xbootldr
      start: 9M
      end: 509M

    - id: rootfs
      type: root
      start: 509M

  filesystems:
  - deviceId: boot
    type: ext4
    mountPoint:
      path: /boot

  - deviceId: rootfs
    type: ext4
    mountPoint:
      path: /

os:
  bootloader:
    resetType: hard-reset

  hostname: azurelinux

  kernelCommandLine:
    extraCommandLine:
    - console=ttyS0

  packages:
    installLists:
    - packagelists/azurevm-packages.json
    - packagelists/core-packages-image.json
    - packagelists/hyperv-packages.json
    - packagelists/marketplace-tools-packages.json

  additionalFiles:
  - source: additionalconfigs/51-ptp-hyperv.rules
    destination: /etc/udev/rules.d/51-ptp-hyperv.rules

  - source: additionalconfigs/chrony.cfg
    destination: /etc/chrony.conf

  - source: additionalconfigs/cloud-init.cfg
    destination: /etc/cloud/cloud.cfg

  - source: additionalconfigs/wait-for-ptp-hyperv.conf
    destination: /etc/systemd/system/chronyd.service.d/wait-for-ptp-hyperv.conf

scripts:
  finalizeCustomization:
  - path: additionalconfigs/configure-systemd-networkd.sh
