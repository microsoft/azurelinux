[components.kernel]

# Set rhel to 0 to avoid deps on non-existent cert packages
# (rhel=10 would engage RHEL-specific BuildRequires)
# Set debugbuildsenabled to 0 to avoid deps on debuginfo packages
# Build with the following settings:
# - baseonly: builds the base kernel without additional features or modules
# Build without the following:
# - debug: builds the debug kernel variant
# - configchecks: builds the kernel with configuration checks enabled
# - efiuki: builds kernel-uki
[components."kernel".build]
defines = { rhel = "0", debugbuildsenabled = "0" }
with = ["baseonly"]
without = ["debug", "configchecks", "efiuki"]

[[components.kernel.overlays]]
type = "spec-search-replace"
description = "Fix RPM 6.x parametric macro getopt issue with dashes in log_msg argument"
regex = '%\{log_msg "Cannot build --with baseonly, up build is disabled"\}'
replacement = '%{log_msg -- "Cannot build --with baseonly, up build is disabled"}'
